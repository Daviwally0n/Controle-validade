<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Controle de Validades</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#343a40">

  <!-- CSS -->
  <link rel="stylesheet" href="css/bootstrap.min.css">

  <!-- ProteÃ§Ã£o simples (login local) -->
  <script>
    if (localStorage.getItem("auth") !== "true") {
      window.location.href = "index.html";
    }
  </script>
</head>

<body
  class="container py-3"
  style="
    background-image: url('images/armazem1.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
  "
>

  <!-- TOPO -->
  <div class="d-flex justify-content-between align-items-center mb-3 bg-light p-2 rounded">
    <h5 class="mb-0">Controle de Validades</h5>
    <button class="btn btn-danger btn-sm" onclick="logout()">Sair</button>
  </div>

  <p class="text-light">
    UsuÃ¡rio: <strong id="usuarioLogado"></strong>
  </p>

  <!-- SCANNER -->
  <div class="text-center my-3">
    <button class="btn btn-primary" onclick="iniciarScanner()">ðŸ“· Escanear Produto</button>
  </div>

  <div id="scanner" class="mb-3"></div>

  <!-- LISTA -->
  <div class="table-responsive bg-white rounded">
    <table class="table table-bordered mb-0">
      <thead class="thead-dark">
        <tr>
          <th>Produto</th>
          <th>Qtd</th>
          <th>Validade</th>
          <th>AÃ§Ã£o</th>
        </tr>
      </thead>
      <tbody id="listaProdutos"></tbody>
    </table>
  </div>

  <!-- EXPORTAR -->
  <button class="btn btn-success btn-block mt-3" onclick="exportarPDF()">
    Exportar PDF
  </button>

  <!-- LIBS -->
  <script src="https://unpkg.com/quagga/dist/quagga.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- APP -->
  <script src="js/app.js"></script>

  <!-- SERVICE WORKER -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .then(() => console.log("Service Worker registrado"))
        .catch(err => console.error("Erro no SW:", err));
    }
  </script>

  <!-- LOGOUT LOCAL -->
  <script>
    document.getElementById("usuarioLogado").innerText =
      localStorage.getItem("usuario") || "";

    function logout() {
      localStorage.removeItem("auth");
      localStorage.removeItem("usuario");
      window.location.href = "index.html";
    }
  </script>

</body>
</html>

